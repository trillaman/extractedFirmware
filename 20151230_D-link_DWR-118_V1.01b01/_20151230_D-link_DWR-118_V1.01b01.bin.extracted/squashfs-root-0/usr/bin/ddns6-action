#!/bin/sh
#
# ddns                     This script starts or stops a ddns
#

# From AUTOCONF
prefix=
exec_prefix=${prefix}

# Paths to programs
UVM=/usr/bin/uvm
UO_PATH=/usr/uo/
UO_FILE=ddns6.conf.uo
CONF_PATH=/etc/
CONF_FILE=ddns6.conf
DDNS_EXEC=/usr/sbin/ddns6
DDNS_PIDFILE=/var/run/ddns6.pid

start() {
	local err; err=0
    echo -n "start ddnsv6 ..."
    $UVM $UO_PATH$UO_FILE > $CONF_PATH$CONF_FILE 
	$DDNS_EXEC &
    echo "DDNSv6 Start Function Called"   #debug message added by horowitz
	return $err
}

stop() {
	if [ -e "$DDNS_PIDFILE" ] ; then
		DDNS_PID=`cat "$DDNS_PIDFILE"`
		echo "Killing ddns ($DDNS_PID)"
		kill $DDNS_PID > /dev/null 2>&1
	else
		echo "$DDNS_PIDFILE not exit!"
		err=1
	fi
    echo "DDNSv6 Stop Function Called"   #debug message added by horowitz
	return $err
}

usage() {
	echo "$0 [start|stop|restart|reload|config]"
    echo "DDNSv6 Usage Function Called"  #debug message added by horowitz
	exit 1
}

# +++++++++++++++ main ++++++++++++++++++++++ 
[ -z "$1" ] && usage;

err=0

case "$1" in
	config)		;;
	start)		start;;
	stop)		stop;;
	reload)		;;
	restart)	stop; start;;
	*)		usage;;
esac
if [ $? = "0" ] ; then
	echo $0 $@ ok
else
	echo $0 $@ error
	err=1
fi
echo "Report:: DDNSv6 Script $0 is executed, executed function is $1"  #debug message added by horowitz
exit $err
